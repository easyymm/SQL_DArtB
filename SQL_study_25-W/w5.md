[25-W SQL 스터디] 5주차 과제
=========
## 목차

|번호|문제|
|---|-----| 
|1| [카테고리 별 도서 판매량 집계하기](#문제1)  |
|2| [오랜 기간 보호한 동물(2)](#문제2)  |
|3| [대여 기록이 존재하는 자동차 리스트 구하기](#문제3)  |  
|4| [즐겨찾기가 가장 많은 식당 정보 출력하기](#문제4)  |  
|5| [없어진 기록 찾기](#문제5) | 
|6| [대장균의 크기에 따라 분류하기 1](#문제6) | 
|7| [자동차 대여 기록에서 대여중 / 대여 가능 여부 구분하기](#문제7) | 
|8| [헤비 유저가 소유한 장소](#문제8) | 
|9| [특정 조건을 만족하는 물고기별 수와 최대 길이 구하기](#문제9) | 
|10| [대장균들의 자식의 수 구하기](#문제10) | 
|11| [업그레이드 할 수 없는 아이템 구하기](#문제11) | 
|12| [물고기 종류 별 대어 찾기](#문제12) | 
|13| [대장균의 크기에 따라 분류하기 2](#문제13) | 
|14| [](#문제14) | 
|15| [](#문제15) | 
---

## 문제1
> 🔍 **1. 카테고리 별 도서 판매량 집계하기**  
사용 함수: GROUP BY

문제 링크: [programmers](https://school.programmers.co.kr/learn/courses/30/lessons/144855)

날짜: 25/02/05(수)


### 문제
2022년 1월의 카테고리 별 도서 판매량을 합산하고, 카테고리(CATEGORY), 총 판매량(TOTAL_SALES) 리스트를 출력하는 SQL문을 작성해주세요.
결과는 카테고리명을 기준으로 오름차순 정렬해주세요.

### SQL 쿼리(정답)
```SQL
SELECT 
    CATEGORY,
    SUM(SALES) AS TOTAL_SALES
FROM BOOK AS B
JOIN BOOK_SALES AS S
USING (BOOK_ID)
WHERE EXTRACT(YEAR_MONTH FROM SALES_DATE) = 202201
GROUP BY CATEGORY
ORDER BY CATEGORY
```
### 실행 결과(정답)
```SQL
CATEGORY  TOTAL_SALES
---------------------
경제	  101
기술	  151
생활	  86
소설	  60
인문	  51
```

### 풀이 과정 및 고민한 점
```SQL
1. 선교가 EXTRACT 함수를 알려주었다. 선교야고마워~
SELECT 
    CATEGORY,
    SUM(SALES) AS TOTAL_SALES
FROM BOOK AS B
JOIN BOOK_SALES AS S
USING (BOOK_ID)
WHERE EXTRACT(YEAR_MONTH FROM SALES_DATE) = 202201
GROUP BY CATEGORY
ORDER BY CATEGORY
```

---
## 문제2
> 🔍 **2. 오랜 기간 보호한 동물(2)**  
사용 함수: String, Date

문제 링크: [programmers](https://school.programmers.co.kr/learn/courses/30/lessons/59411)

날짜: 25/02/06(목)



### 문제
입양을 간 동물 중, 보호 기간이 가장 길었던 동물 두 마리의 아이디와 이름을 조회하는 SQL문을 작성해주세요. 이때 결과는 보호 기간이 긴 순으로 조회해야 합니다.

### SQL 쿼리(정답)
```SQL
SELECT 
    O.ANIMAL_ID,
    O.NAME
FROM ANIMAL_INS AS I
RIGHT JOIN ANIMAL_OUTS AS O
USING (ANIMAL_ID)
ORDER BY DATEDIFF(O.DATETIME, I.DATETIME) DESC
LIMIT 2
```
### 실행 결과(정답)
```SQL
ANIMAL_ID	NAME
A362707	Girly Girl
A370507	Emily
```

### 풀이 과정 및 고민한 점
```SQL
1. SELECT 절에 DATEDIFF 함수를 넣지 않아야 하므로 위치를 고민함.

SELECT 
    O.ANIMAL_ID,
    O.NAME
FROM ANIMAL_INS AS I
RIGHT JOIN ANIMAL_OUTS AS O
USING (ANIMAL_ID)
ORDER BY DATEDIFF(O.DATETIME, I.DATETIME) DESC
LIMIT 2
```

---
## 문제3
> 🔍 **3. 대여 기록이 존재하는 자동차 리스트 구하기**  
사용 함수: String, Date

문제 링크: [programmers](https://school.programmers.co.kr/learn/courses/30/lessons/157341)

날짜: 25/02/06(목)


### 문제
CAR_RENTAL_COMPANY_CAR 테이블과 CAR_RENTAL_COMPANY_RENTAL_HISTORY 테이블에서 자동차 종류가 '세단'인 자동차들 중 10월에 대여를 시작한 기록이 있는 자동차 ID 리스트를 출력하는 SQL문을 작성해주세요. 자동차 ID 리스트는 중복이 없어야 하며, 자동차 ID를 기준으로 내림차순 정렬해주세요.

### SQL 쿼리(정답)
```SQL
SELECT 
    DISTINCT(CAR_ID)
FROM CAR_RENTAL_COMPANY_CAR AS C
JOIN CAR_RENTAL_COMPANY_RENTAL_HISTORY AS H
USING (CAR_ID)
WHERE CAR_TYPE = '세단' 
    AND EXTRACT(MONTH FROM START_DATE) = 10
ORDER BY CAR_ID DESC
```
### 실행 결과(정답)
```SQL
CAR_ID
------
23
10
3
```

### 풀이 과정 및 고민한 점
```SQL
1. 차종이 세단이며, 대여시작월이 10인 자동차 ID 출력

SELECT 
    CAR_ID
FROM CAR_RENTAL_COMPANY_CAR AS C
JOIN CAR_RENTAL_COMPANY_RENTAL_HISTORY AS H
USING (CAR_ID)
WHERE CAR_TYPE = '세단' 
    AND EXTRACT(MONTH FROM START_DATE) = 10

2. CAR_ID 중복 X, 내림차순 정렬

SELECT 
    DISTINCT(CAR_ID)
FROM CAR_RENTAL_COMPANY_CAR AS C
JOIN CAR_RENTAL_COMPANY_RENTAL_HISTORY AS H
USING (CAR_ID)
WHERE CAR_TYPE = '세단' 
    AND EXTRACT(MONTH FROM START_DATE) = 10
ORDER BY CAR_ID DESC
```

---
## 문제4
> 🔍 **4. 즐겨찾기가 가장 많은 식당 정보 출력하기**  
사용 함수: GROUP BY

문제 링크: [programmers](https://school.programmers.co.kr/learn/courses/30/lessons/131123)

날짜: 25/02/06(목)



### 문제
REST_INFO 테이블에서 음식종류별로 즐겨찾기수가 가장 많은 식당의 음식 종류, ID, 식당 이름, 즐겨찾기수를 조회하는 SQL문을 작성해주세요. 이때 결과는 음식 종류를 기준으로 내림차순 정렬해주세요.

### SQL 쿼리(정답)
```SQL
SELECT     
    FOOD_TYPE,
    REST_ID,
    REST_NAME,
    FAVORITES
FROM REST_INFO
WHERE (FOOD_TYPE, FAVORITES) IN (
    SELECT     
        FOOD_TYPE, 
        MAX(FAVORITES) AS FAVORITES
    FROM REST_INFO
    GROUP BY FOOD_TYPE)
ORDER BY FOOD_TYPE DESC
```
### 실행 결과(정답)
```SQL
FOOD_TYPE  REST_ID  REST_NAME   FAVORITES
-----------------------------------------
한식	   00001	은돼지식당	 734
중식	   00015	만정	     20
일식	   00004	스시사카우스 230
양식	   00003	따띠따띠뜨	 102
분식	   00008	애플우스	 151
```

### 풀이 과정 및 고민한 점
```SQL
1. 기본 쿼리 구성

SELECT     
    FOOD_TYPE,
    REST_ID,
    REST_NAME,
    FAVORITES
FROM REST_INFO
ORDER BY FOOD_TYPE DESC

2. 서브쿼리로 MAX(FAVORITES) 구하기

WHERE (FOOD_TYPE, FAVORITES) IN (
    SELECT     
        FOOD_TYPE, 
        MAX(FAVORITES) AS FAVORITES
    FROM REST_INFO
    GROUP BY FOOD_TYPE)

WHERE절 서브쿼리가 어렵다.
```

---
## 문제5
> 🔍 **5. 없어진 기록 찾기**  
사용 함수: JOIN

문제 링크: [programmers](https://school.programmers.co.kr/learn/courses/30/lessons/59042)

날짜: 25/02/06(목)


### 문제
천재지변으로 인해 일부 데이터가 유실되었습니다. 입양을 간 기록은 있는데, 보호소에 들어온 기록이 없는 동물의 ID와 이름을 ID 순으로 조회하는 SQL문을 작성해주세요.

### SQL 쿼리(정답)
```SQL
SELECT 
    O.ANIMAL_ID,
    O.NAME
FROM ANIMAL_INS AS I
RIGHT JOIN ANIMAL_OUTS AS O
USING (ANIMAL_ID)
WHERE I.ANIMAL_ID IS NULL
ORDER BY ANIMAL_ID
```
### 실행 결과(정답)
```SQL
ANIMAL_ID NAME
----------------
A349480   Daisy
A349733   Allie
A349990   Spice
A362137   *Darcy
```

### 풀이 과정 및 고민한 점
```SQL
1. OUTS 테이블에는 있지만 IN 테이블에는 없는 ANIMAL_ID를 구해야 함.
OUTS 테이블 기준으로 조인 후 IN 테이블의 값이 NULL인 행만 추출

SELECT 
    O.ANIMAL_ID,
    O.NAME
FROM ANIMAL_INS AS I
RIGHT JOIN ANIMAL_OUTS AS O
USING (ANIMAL_ID)
WHERE I.ANIMAL_ID IS NULL
ORDER BY ANIMAL_ID
```


---
## 문제6
> 🔍 **6. 대장균의 크기에 따라 분류하기 1**  
사용 함수: SELECT

문제 링크: [programmers](https://school.programmers.co.kr/learn/courses/30/lessons/299307)

날짜: 25/02/06(목)


### 문제
대장균 개체의 크기가 100 이하라면 'LOW', 100 초과 1000 이하라면 'MEDIUM', 1000 초과라면 'HIGH' 라고 분류합니다. 대장균 개체의 ID(ID) 와 분류(SIZE)를 출력하는 SQL 문을 작성해주세요.이때 결과는 개체의 ID 에 대해 오름차순 정렬해주세요.

### SQL 쿼리(정답)
```SQL
SELECT 
    ID,
    CASE
        WHEN SIZE_OF_COLONY <= 100 THEN 'LOW'
        WHEN SIZE_OF_COLONY <= 1000 THEN 'MEDIUM'
        ELSE 'HIGH'
    END AS SIZE
FROM ECOLI_DATA
ORDER BY ID
```
### 실행 결과(정답)
```SQL
ID	SIZE
----------
1	LOW
2	MEDIUM
3	HIGH
```

### 풀이 과정 및 고민한 점
```SQL
1. CASE WHEN 문으로 SIZE 나누기
이때, LOW가 먼저 분류되므로 MEDIUM 정의 시 '100 초과' 조건은 생략 가능

SELECT 
    ID,
    CASE
        WHEN SIZE_OF_COLONY <= 100 THEN 'LOW'
        WHEN SIZE_OF_COLONY <= 1000 THEN 'MEDIUM'
        ELSE 'HIGH'
    END AS SIZE
FROM ECOLI_DATA
ORDER BY ID
```

---
## 문제7
> 🔍 **7. 자동차 대여 기록에서 대여중 / 대여 가능 여부 구분하기**  
사용 함수: GROUP BY

문제 링크: [programmers](https://school.programmers.co.kr/learn/courses/30/lessons/157340)

날짜: 25/02/06(목)

### 문제
CAR_RENTAL_COMPANY_RENTAL_HISTORY 테이블에서 2022년 10월 16일에 대여 중인 자동차인 경우 '대여중' 이라고 표시하고, 대여 중이지 않은 자동차인 경우 '대여 가능'을 표시하는 컬럼(컬럼명: AVAILABILITY)을 추가하여 자동차 ID와 AVAILABILITY 리스트를 출력하는 SQL문을 작성해주세요. 이때 반납 날짜가 2022년 10월 16일인 경우에도 '대여중'으로 표시해주시고 결과는 자동차 ID를 기준으로 내림차순 정렬해주세요.

### SQL 쿼리(정답)
```SQL
SELECT 
    DISTINCT CAR_ID,
    CASE
        WHEN CAR_ID IN (
            SELECT CAR_ID 
            FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY 
            WHERE START_DATE <= '2022-10-16' AND END_DATE >= '2022-10-16'
        ) THEN '대여중'
        ELSE '대여 가능'
    END AS AVAILABILITY
FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
ORDER BY CAR_ID DESC
```
### 실행 결과(정답)
```SQL
CAR_ID	AVAILABILITY
--------------------
30	    대여 가능
29	    대여중
.
.
.
```

### 풀이 과정 및 고민한 점
```SQL
1. 대여시작일과 대여종료일 사이에 '2022-10-16'이 있는 자동차 ID 추출

SELECT CAR_ID 
FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY 
WHERE START_DATE <= '2022-10-16' AND END_DATE >= '2022-10-16'

2. CASE WHEN에 넣어 1에 해당하는 자동차 ID는 '대여중', 아니면 '대여가능'으로 설정
CAR_ID가 중복이므로 DISTINCT 사용

SELECT 
    DISTINCT CAR_ID,
    CASE
        WHEN CAR_ID IN (
            SELECT CAR_ID 
            FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY 
            WHERE START_DATE <= '2022-10-16' AND END_DATE >= '2022-10-16'
        ) THEN '대여중'
        ELSE '대여 가능'
    END AS AVAILABILITY
FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
ORDER BY CAR_ID DESC
```

---
## 문제8
> 🔍 **8. 헤비 유저가 소유한 장소**  
사용 함수: 

문제 링크: [programmers](http://school.programmers.co.kr/learn/courses/30/lessons/77487)

날짜: 25/02/06(목)


### 문제
이 서비스에서는 공간을 둘 이상 등록한 사람을 "헤비 유저"라고 부릅니다. 헤비 유저가 등록한 공간의 정보를 아이디 순으로 조회하는 SQL문을 작성해주세요.

### SQL 쿼리(정답)
```SQL
SELECT 
    ID,
    NAME,
    HOST_ID
FROM PLACES
WHERE HOST_ID IN (
        SELECT 
            HOST_ID
        FROM PLACES
        GROUP BY HOST_ID
        HAVING COUNT(ID) >= 2)
ORDER BY ID
```
### 실행 결과(정답)
```SQL
ID	    NAME	                                        HOST_ID
----------------------------------------------------------------
4431977	BOUTIQUE STAYS - Somerset Terrace, Pet Friendly	760849
5194998	BOUTIQUE STAYS - Elwood Beaches 3, Pet Friendly	760849
```

### 풀이 과정 및 고민한 점
```SQL
1. HOST_ID가 둘 이상인 행만 추출
SELECT 
    HOST_ID
FROM PLACES
GROUP BY HOST_ID
HAVING COUNT(ID) >= 2

2. 1을 서브쿼리로 만듦

SELECT 
    ID,
    NAME,
    HOST_ID
FROM PLACES
WHERE HOST_ID IN (
        SELECT 
            HOST_ID
        FROM PLACES
        GROUP BY HOST_ID
        HAVING COUNT(ID) >= 2)
ORDER BY ID
```



---
## 문제9
> 🔍 **9. 특정 조건을 만족하는 물고기별 수와 최대 길이 구하기**  
사용 함수: GROUP BY

문제 링크: [programmers](문제 링크)

날짜: 25/MM/DD()


### 문제


### SQL 쿼리(정답)
```SQL

```
### 실행 결과(정답)
```SQL

```

### 풀이 과정 및 고민한 점
```SQL

```


---
## 문제10
> 🔍 **10. 대장균들의 자식의 수 구하기**  
사용 함수: SELECT

문제 링크: [programmers](문제 링크)

날짜: 25/MM/DD()


### 문제


### SQL 쿼리(정답)
```SQL

```
### 실행 결과(정답)
```SQL

```

### 풀이 과정 및 고민한 점
```SQL

```

---
## 문제11
> 🔍 **11. 업그레이드 할 수 없는 아이템 구하기**  
사용 함수: IS NULL

문제 링크: [programmers](문제 링크)

날짜: 25/MM/DD()



### 문제


### SQL 쿼리(정답)
```SQL

```
### 실행 결과(정답)
```SQL

```

### 풀이 과정 및 고민한 점
```SQL

```

---
## 문제12
> 🔍 **12. 물고기 종류 별 대어 찾기**  
사용 함수: SUM, MAX, MIN

문제 링크: [programmers](문제 링크)

날짜: 25/MM/DD()


### 문제


### SQL 쿼리(정답)
```SQL

```
### 실행 결과(정답)
```SQL

```

### 풀이 과정 및 고민한 점
```SQL

```



---
## 문제13
> 🔍 **13. 대장균의 크기에 따라 분류하기 2**  
사용 함수: 

문제 링크: [programmers](문제 링크)

날짜: 25/MM/DD()



### 문제


### SQL 쿼리(정답)
```SQL

```
### 실행 결과(정답)
```SQL

```

### 풀이 과정 및 고민한 점
```SQL

```

---
## 문제14
> 🔍 **14. 문제**  
사용 함수: 

문제 링크: [programmers](문제 링크)

날짜: 25/MM/DD()


### 문제


### SQL 쿼리(정답)
```SQL

```
### 실행 결과(정답)
```SQL

```

### 풀이 과정 및 고민한 점
```SQL

```


---
## 문제15
> 🔍 **15. 문제**  
사용 함수: 

문제 링크: [programmers](문제 링크)

날짜: 25/MM/DD()


### 문제


### SQL 쿼리(정답)
```SQL

```
### 실행 결과(정답)
```SQL

```

### 풀이 과정 및 고민한 점
```SQL

```

---

